<div class="inner-container">
  <h1>Invoice Details</h1>
  <form [formGroup]="invoiceForm" (ngSubmit)="onSubmit()">
    <table
      mat-table
      [dataSource]="dataSource"
      class="mat-elevation-z2"
      formArrayName="products"
    >
      <!-- Product Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Product Name</th>
        <td
          mat-cell
          *matCellDef="let product; let i = index"
          [formGroupName]="i"
        >
          <mat-form-field class="full-width" subscriptSizing="dynamic">
            <input matInput formControlName="name" placeholder="Product Name" />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Price Column -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Price</th>
        <td
          mat-cell
          *matCellDef="let product; let i = index"
          [formGroupName]="i"
        >
          <mat-form-field class="full-width" subscriptSizing="dynamic">
            <input matInput formControlName="price" placeholder="Price" />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Unit of Measurement Column -->
      <ng-container matColumnDef="unitOfMeasurement">
        <th mat-header-cell *matHeaderCellDef>Unit of Measurement</th>
        <td
          mat-cell
          *matCellDef="let product; let i = index"
          [formGroupName]="i"
        >
          <mat-form-field class="full-width" subscriptSizing="dynamic">
            <input
              matInput
              formControlName="unitOfMeasurement"
              placeholder="Unit of Measurement"
            />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- TVA Value Column -->
      <ng-container matColumnDef="tvaValue">
        <th mat-header-cell *matHeaderCellDef>TVA Value</th>
        <td
          mat-cell
          *matCellDef="let product; let i = index"
          [formGroupName]="i"
        >
          <mat-form-field class="full-width" subscriptSizing="dynamic">
            <input
              matInput
              formControlName="tvaValue"
              placeholder="TVA Value"
            />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Contains TVA Checkbox Column -->
      <ng-container matColumnDef="containsTVA">
        <th mat-header-cell *matHeaderCellDef>Contains TVA</th>
        <td
          mat-cell
          *matCellDef="let product; let i = index"
          [formGroupName]="i"
        >
          <mat-checkbox formControlName="containsTVA">Yes</mat-checkbox>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let product; let i = index">
          <button
            mat-icon-button
            color="primary"
            (click)="deleteProduct(i)"
            matTooltip="Remove"
          >
            <mat-icon>delete</mat-icon>
          </button>
          <button
            mat-icon-button
            color="primary"
            (click)="addProduct()"
            matTooltip="Add"
          >
            <mat-icon>add_circle_outline</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </form>
</div>
